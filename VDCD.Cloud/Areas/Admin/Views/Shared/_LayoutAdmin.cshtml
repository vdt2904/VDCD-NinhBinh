<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Dashboard Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="~/Admin/css/styles.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <link rel="icon" href="/uploads/cbf7823d-e5f1-49fd-801a-8bf2253d4547_iconlogo.png" sizes="32x32" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.12/themes/default/style.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.12/jstree.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
</head>
<body class="sb-nav-fixed">

    @await Html.PartialAsync("/Areas/Admin/Views/Shared/_PartialHeader.cshtml");
    <div id="layoutSidenav">
        @await Html.PartialAsync("/Areas/Admin/Views/Shared/_PartialMenu.cshtml");
        <div id="layoutSidenav_content">
            @RenderBody()
           @*  @await Html.PartialAsync("/Areas/Admin/Views/Shared/_PartialFooter.cshtml"); *@
        </div>
    </div>
    <div id="notify-container"></div>
    <style>
#notify-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 9999;
}

.notify-item {
    background: #fff;
    border-left: 4px solid #0d6efd;
    border-radius: 8px;
    box-shadow: 0 8px 25px rgba(0,0,0,.15);
    padding: 14px 16px;
    margin-bottom: 12px;
    width: 320px;
    cursor: pointer;
    animation: slideIn .35s ease;
}

.notify-item:hover {
    background: #f8f9fa;
}

.notify-title {
    font-weight: 600;
    margin-bottom: 4px;
}

.notify-time {
    font-size: 12px;
    color: #6c757d;
}

@@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateX(40px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}
</style>

    <script src="~/Admin/js/scripts.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
    <script src="~/Admin/assets/demo/chart-area-demo.js"></script>
    <script src="~/Admin/assets/demo/chart-bar-demo.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
    <script src="~/Admin/js/datatables-simple-demo.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/8.0.0/signalr.min.js"></script>

    <script>
        const container = document.getElementById("notify-container");

        function showNotification(data) {
            const div = document.createElement("div");
            div.className = "notify-item";

            div.innerHTML = `
                <div class="notify-title">
                    📩 Liên hệ mới từ ${data.name}
                </div>
                <div class="notify-time">
                    ${data.time || "Vừa xong"}
                </div>
            `;

            // Click → chuyển trang
            div.addEventListener("click", function () {
                window.location.href = "/admin/ContactMessage/index";
            });

            container.appendChild(div);

            // Tự ẩn sau 8s
            setTimeout(() => {
                div.remove();
            }, 8000);
        }

        // SignalR
        const connection = new signalR.HubConnectionBuilder()
            .withUrl("/hub/notification")
            .configureLogging(signalR.LogLevel.Information)
            .build();

        connection.on("NewContact", function (data) {
            showNotification(data);
        });

        connection.start()
            .catch(err => console.error(err));
    </script>


</body>
</html>
